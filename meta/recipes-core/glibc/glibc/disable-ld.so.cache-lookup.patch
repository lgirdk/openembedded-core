From 440b06289c2d8eeadc452935670adab123bf3636 Mon Sep 17 00:00:00 2001
From: Andre McCurdy <armccurdy@gmail.com>
Date: Wed, 21 Sep 2016 15:17:15 -0700
Subject: [PATCH] disable ld.so.cache lookup

Force the dynamic linker only pick up libraries from the library path
and rpath and ignore /etc/ld.so.cache

This patch is the equivalent of always passing the --inhibit-ldcache
option to ld.so:

  https://sourceware.org/git/?p=glibc.git;a=commit;h=73d65cc3784b1413b017fed31550ec11e717e45b

Signed-off-by: Andre McCurdy <armccurdy@gmail.com>
---
 sysdeps/unix/sysv/linux/configure    | 4 ++--
 sysdeps/unix/sysv/linux/configure.ac | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/sysdeps/unix/sysv/linux/configure b/sysdeps/unix/sysv/linux/configure
index cace758c01..45ab6c96a1 100644
--- a/sysdeps/unix/sysv/linux/configure
+++ b/sysdeps/unix/sysv/linux/configure
@@ -127,8 +127,8 @@ if test "$prefix" = "/usr/local" -o "$prefix" = "/usr/local/" -o "$prefix" = "NO
 fi
 
 
-# One Linux we use ldconfig.
-use_ldconfig=yes
+# Usually on Linux we use ldconfig, but not in this case
+use_ldconfig=no
 
 if test $host = $build; then
   # If $prefix/include/{net,scsi} are symlinks, make install will
diff --git a/sysdeps/unix/sysv/linux/configure.ac b/sysdeps/unix/sysv/linux/configure.ac
index 13abda0a51..dbb15b92d3 100644
--- a/sysdeps/unix/sysv/linux/configure.ac
+++ b/sysdeps/unix/sysv/linux/configure.ac
@@ -86,8 +86,8 @@ if test "$prefix" = "/usr/local" -o "$prefix" = "/usr/local/" -o "$prefix" = "NO
 fi
 
 
-# One Linux we use ldconfig.
-use_ldconfig=yes
+# Usually on Linux we use ldconfig, but not in this case
+use_ldconfig=no
 
 if test $host = $build; then
   # If $prefix/include/{net,scsi} are symlinks, make install will
-- 
2.24.0

